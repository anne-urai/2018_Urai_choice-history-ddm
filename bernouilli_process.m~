function bernouilli_process

% define each trial as a repeat 1 or alternate 0 with probability p
% (for each individual, p will be computed as in Figure 2b)
%
% Q: given p, what is the probability of repeating the choice that was made 
% l lags into the past?
%

% ======================================================================== %
% first, enumerate all the possible sequences and their likelihood given p
% ======================================================================== %
%{
lag 1
XY = A = (1-p)
XX = R = p

lag 2
XXX = RR = p*p
XXY = RA = p*(1-p)
XYX = AA = (p-1)*(p-1)
XYY = AR = (p-1)*p

lag 3
XXXX = RRR = p*p*p
XXXY = RRA
XXYX = RAA
XXYY = RAR
XYXX = ARR
XYXY = AAA
XYYX = ARA
XYYY = ARR

%}

% DO THIS automagically
% generate all the possible sequences of repetitions and alternations
all_binary_sequences = @(x) dec2bin(2^x-1:-1:0)-'0';
sequences_rep_alt = all_binary_sequences(7);

% COMPUTE THE PROBABILITY OF EACH SEQUENCE
p = 0.6;
sequences_prob = sequences_rep_alt;
sequences_prob(sequences_prob == 1) = p;
sequences_prob(sequences_prob == 0) = 1 - p;

prob = prod(sequences_prob, 2);
assert(roundn(sum(prob), -3) == 1, 'sequence probabilities must sum up to 1');

% FOR EAC

